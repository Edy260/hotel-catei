<!DOCTYPE html>
<html lang="ro">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Rezervare - Hotel pentru C캒탵ei</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css">
</head>

<body class="rezervare">

<nav class="navbar">
  <div class="nav-inner">

    <!-- St칙nga: Telefon + Loca탵ie -->
    <div class="nav-left">
      <a class="nav-pill" href="tel:+40735626065" title="Sun캒">
        <span class="nav-ico">游</span>
        <span>0735 626 065</span>
      </a>

      <!-- FIX: href corect -->
      <a class="nav-pill" target="_blank" rel="noopener"
         href="https://www.google.com/maps/search/?api=1&query=DN4%20184"
         title="Deschide 칥n Google Maps">
        <span class="nav-ico">游늸</span>
        <span>DN4 184</span>
      </a>
    </div>

    <!-- Mijloc: Logo premium + nume -->
    <a class="nav-brand" href="index.html" aria-label="Canine Boutique Hotel - Acas캒">
  <span class="brand-logo-wrap">
    <img src="images/logo.png" alt="Canine Boutique Hotel" class="brand-logo">
  </span>
</a>


    <!-- Dreapta: Meniu -->
    <ul class="nav-menu">
      <li><a href="index.html">Acas캒</a></li>
      <li><a href="servicii.html">Servicii</a></li>
      <li><a href="galerie.html">Galerie</a></li>
      <li><a href="rezervare.html" class="is-active">Rezervare</a></li>
    </ul>

  </div>
</nav>

<section class="container glass-section">
  <h2>Rezervare online</h2>

  <!-- buton c캒tre disponibilitate -->
  <div style="margin: 10px 0 14px; display:flex; gap:10px; flex-wrap:wrap;">
    <a class="price-btn" href="disponibilitate.html">Verific캒 disponibilitatea</a>
    <span class="reserve-hint">
  Dac캒 nu sunt camere, verific캒 aici perioade alternative.
</span>

  </div>

  <!-- mesaj pentru erori / succes -->
  <div id="reserve-msg"></div>

  <form id="reserve-form" class="form">
    <input type="text" id="nume" placeholder="Nume" required>
    <input type="tel" id="telefon" placeholder="Telefon" required>

    <input type="date" id="start" required>
    <input type="date" id="end" required>

    <!-- Tip camer캒 -->
    <select id="tip-camera" required>
      <option value="" disabled selected>Alege tip camer캒</option>
      <option value="standard">Camer캒 Standard</option>
      <option value="confort">Camer캒 Confort</option>
      <option value="premium">Camer캒 Premium</option>
      <option value="vip">VIP Dog Room</option>
    </select>

    <!-- Cantitate -->
    <input type="number" id="cantitate" min="1" value="1" required>

    <textarea id="mesaj" placeholder="Detalii despre c캒탵el"></textarea>

    <button type="submit">Trimite pe WhatsApp</button>
  </form>
</section>

<div id="footer-placeholder"></div>


<!-- app.js (navbar hide etc) -->
<script src="app.js" defer></script>

<!-- disponibilitate + rezervare (demo localStorage) -->
<script>
  // c칙te camere ai 칥n total pe tip (seteaz캒 tu)
  const INVENTORY = { standard: 5, confort: 3, premium: 2, vip: 1 };

  function parseDateLocal(dateStr) {
    const [y, m, d] = dateStr.split("-").map(Number);
    return new Date(y, m - 1, d, 12, 0, 0); // pr칙nz -> safe timezone
  }

  function overlaps(aStart, aEnd, bStart, bEnd) {
    // [start, end) ca la hotel
    return aStart < bEnd && bStart < aEnd;
  }

  function loadBookings() {
    try { return JSON.parse(localStorage.getItem("bookings_v1") || "[]"); }
    catch { return []; }
  }

  function saveBookings(bookings) {
    localStorage.setItem("bookings_v1", JSON.stringify(bookings));
  }

  function bookedQtyFor(type, start, end) {
    const bookings = loadBookings();
    let qty = 0;
    for (const b of bookings) {
      if (b.type !== type) continue;
      const bs = parseDateLocal(b.start);
      const be = parseDateLocal(b.end);
      if (overlaps(start, end, bs, be)) qty += (b.qty || 1);
    }
    return qty;
  }

  function showMsg(html, isError = false) {
    const box = document.getElementById("reserve-msg");
    if (!box) return;
    box.innerHTML = html;
    box.style.padding = "12px";
    box.style.borderRadius = "14px";
    box.style.margin = "10px 0 14px";
    box.style.background = isError ? "rgba(255,0,0,.08)" : "rgba(0,180,80,.10)";
  }

  // submit rezervare -> verific캒 stoc -> apoi trimite WhatsApp
  const form = document.getElementById("reserve-form");
  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const nume = document.getElementById("nume").value.trim();
    const telefon = document.getElementById("telefon").value.trim();
    const startStr = document.getElementById("start").value;
    const endStr = document.getElementById("end").value;
    const type = document.getElementById("tip-camera").value;
    const qty = Number(document.getElementById("cantitate").value || 1);
    const mesaj = document.getElementById("mesaj").value.trim();

    if (!nume || !telefon || !startStr || !endStr || !type || qty < 1) {
      showMsg("Completeaz캒 toate c칙mpurile obligatorii.", true);
      return;
    }

    const start = parseDateLocal(startStr);
    const end = parseDateLocal(endStr);

    if (!(start < end)) {
      showMsg("Perioada nu este valid캒 (check-out trebuie s캒 fie dup캒 check-in).", true);
      return;
    }

    const alreadyBooked = bookedQtyFor(type, start, end);
    const free = (INVENTORY[type] ?? 0) - alreadyBooked;

    if (free < qty) {
      showMsg(
        `Ne pare r캒u, nu mai avem camere disponibile 칥n perioada selectat캒.<br>
         Te rug캒m s캒 mergi la sec탵iunea <a href="disponibilitate.html"><strong>Verific캒 disponibilitatea</strong></a>
         pentru alte perioade.`,
        true
      );
      return;
    }

    // 칥nregistreaz캒 rezervarea (demo local)
    const bookings = loadBookings();
    bookings.push({
      id: (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now()),
      type,
      qty,
      start: startStr,
      end: endStr,
      createdAt: new Date().toISOString()
    });
    saveBookings(bookings);

    // trimite WhatsApp
    const labels = { standard:"Standard", confort:"Confort", premium:"Premium", vip:"VIP" };
    const text =
      `Salut! Vreau s캒 fac o rezervare.\n\n` +
      `Nume: ${nume}\n` +
      `Telefon: ${telefon}\n` +
      `Perioada: ${startStr} - ${endStr}\n` +
      `Tip camer캒: ${labels[type]}\n` +
      `Num캒r camere: ${qty}\n` +
      `Detalii: ${mesaj || "-"}\n\n` +
      `Mul탵umesc!`;

    const phone = "40735626065";
    window.open(`https://wa.me/${phone}?text=${encodeURIComponent(text)}`, "_blank");

    showMsg("Rezervarea a fost 칥nregistrat캒 (demo) 탳i s-a deschis WhatsApp. Mul탵umim!");
    form.reset();
  });
</script>

</body>
</html>
